# å¯»è·¯ç®—æ³•ç»ƒä¹ 

**å­¦ä¹ å¯»è·¯ç®—æ³•æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ**

- å¯»è·¯æ˜¯å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•
- æ‰€æœ‰çš„æœç´¢çš„ç®—æ³•çš„æ€è·¯çš„éå¸¸ç›¸ä¼¼
- æ‰€ä»¥åœ¨è®²å¹¿åº¦ä¼˜å…ˆçš„ç®—æ³•çš„è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥æŠŠæ·±åº¦ä¼˜å…ˆæœç´¢ç±»çš„éƒ½è®²ä¸€é
- æœç´¢æ˜¯ç®—æ³•é‡Œé¢ç‰¹åˆ«é‡è¦ï¼Œé€šç”¨å‹ä¹Ÿæ˜¯ç‰¹åˆ«å¥½çš„ä¸€ç±»ç®—æ³•
- è¿™é‡Œå¯ä»¥å¸®åŠ©å¤§å®¶åœ¨ç®—æ³•æ–¹é¢æœ‰ä¸€å®šçš„æå‡

**é€šè¿‡å¯è§†åŒ–æ¥ç†è§£ç®—æ³•**

- ç®—æ³•é‡Œé¢ä¹Ÿæ˜¯æœ‰ UI ç›¸å…³çš„éƒ¨åˆ†çš„
- å¹¶ä¸”æœ‰ä¸€äº› JavaScript ç‰¹æœ‰çš„éƒ¨åˆ†
- å­¦ä¹ è¿™éƒ¨åˆ†å¯ä»¥è®©å¤§å®¶å¯¹ JavaScript è¯­è¨€æé«˜ç†Ÿæ‚‰ç¨‹åº¦
- å¹¶ä¸”å¯¹è¯­è¨€é‡Œé¢çš„åº”ç”¨æ–¹å¼è·å¾—ä¸€ä¸ªæ›´æ·±çš„äº†è§£
- è¿˜æœ‰æœ€é‡è¦çš„æ˜¯é€šè¿‡å¼‚æ­¥ç¼–ç¨‹çš„ç‰¹æ€§ï¼Œæ¥è®²è§£ä¸€äº›å¯è§†åŒ–ç›¸å…³çš„çŸ¥è¯†
- é€šè¿‡æŠŠç®—æ³•çš„æ­¥éª¤å¯è§†åŒ–åï¼Œæˆ‘ä»¬å°±å¯ä»¥éå¸¸ç›´è§‚åœ°çœ‹åˆ°ç®—æ³•çš„è¿è½¬çŠ¶å†µ

# å¯»è·¯é—®é¢˜çš„å®šä¹‰

> **å¯»è·¯çš„é—®é¢˜** â€”â€” å°±æ˜¯åœ¨ä¸€å¼ åœ°å›¾ä¸ŠæŒ‡å®šä¸€ä¸ªèµ·ç‚¹å’Œä¸€ä¸ªç»ˆç‚¹ï¼Œä»èµ·ç‚¹é€šè¿‡æ¨ªç«–æ–œå„ä¸ªæ–¹å‘å»æ‰¾åˆ°å®ƒé€šå¾€ç»ˆç‚¹çš„ä¸€ä¸ªè·¯å¾„ã€‚

åœ¨æˆ‘ä»¬çš„è¿™ä¸ªç»ƒä¹ é‡Œé¢æˆ‘ä»¬ä¼šåˆ¶é€ ä¸€å¼  100 x 100 ä¸ªæ ¼å­çš„åœ°å›¾ï¼Œå¹¶ä¸”åœ¨ä¸Šé¢ç»˜åˆ¶æˆ‘ä»¬çš„ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„ã€‚

> åœ¨ä¸€å¼€å§‹æˆ‘ä»¬ä¼šå…ˆç”¨ç®€å•çš„æ¨ªç«–ä¸¤ä¸ªæ–¹å‘æ¥å¯»æ‰¾æˆ‘ä»¬çš„ç»ˆç‚¹ï¼Œå› ä¸ºæ–œå‘çš„è·¯å¾„ä¼šæœ‰ä¸€å®šçš„å·®å¼‚ï¼Œå°¤å…¶æ˜¯åœ¨åœ°å›¾æ¯”è¾ƒç©ºæ—·çš„æƒ…å†µä¸‹ã€‚åé¢æˆ‘ä»¬ä¼šé€æ¸åœ°å¢åŠ å„ç§å„æ ·çš„åŠŸèƒ½ï¼Œç›´åˆ°æˆ‘ä»¬æŠŠæœç´ å…¨éƒ¨è§£å†³å®Œã€‚

# åœ°å›¾ç¼–è¾‘å™¨

åœ¨è¿™ä¹ˆå¤§è§„æ¨¡çš„å¯»è·¯é—®é¢˜å½“ä¸­ï¼Œæˆ‘ä»¬é¦–é€‰éœ€è¦åšä¸€ä¸ªåœ°å›¾ç¼–è¾‘å™¨ã€‚å®ƒçš„åŠŸèƒ½å¦‚ä¸‹ï¼š

1. å¯ä»¥é€šè¿‡é¼ æ ‡å·¦é”®ç‚¹å‡»ï¼Œæˆ–è€…ç‚¹å‡»å¹¶æ‹–åŠ¨å°±å¯ä»¥ç»˜åˆ¶åœ°å›¾
2. å¯ä»¥é€šè¿‡é¼ æ ‡å³é”®ç‚¹å‡»ï¼Œæˆ–è€…ç‚¹å‡»å¹¶æ‹–åŠ¨å°±å¯ä»¥æ¸…æ¥šåœ°å›¾
3. å¯ä»¥ä¿å­˜åœ°å›¾çš„æ•°æ®ï¼Œåˆ·æ–°åœ°å›¾åï¼Œè¿˜å¯ä»¥é‡æ–°ç»˜åˆ¶å‡ºæ¥

é¦–å…ˆæˆ‘ä»¬éœ€è¦ç»˜åˆ¶æˆ‘ä»¬åœ°å›¾çš„åº•ç›˜ï¼Œåœ¨ç»˜åˆ¶ä¹‹å‰æˆ‘ä»¬å°±éœ€è¦ç»™æˆ‘ä»¬çš„ HTML åŠ å…¥ CSSã€‚

æˆ‘ä»¬çš„åº•ç›˜æ˜¯ä¸€ä¸ª 100 x 100 æ ¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªæ ¼å­ä¸€ä¸ªæ ·å¼ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ç”¨ `flex` æ¥å¸ƒå±€å³å¯ã€‚å‡è®¾æˆ‘ä»¬æ¯ä¸ªæ ¼å­éƒ½æ˜¯ `6px` å®½é«˜ï¼Œç„¶åä¾æ¬¡æ¯è¡Œæ’åˆ— 100 ä¸ªã€‚æ‰€ä»¥æˆ‘ä»¬çš„ HTML å¸ƒå±€ä»£ç å°±æ˜¯å¦‚ä¸‹ï¼š

```html
<div id="container">
  <div class="cell"></div>
  <div class="cell"></div>
  <div class="cell"></div>
  <div class="cell"></div>
  ...
</div>
```

- `container` å°±æ˜¯å¤–åŒ…æ¡†
- `cell` å°±æ˜¯é‡Œé¢çš„æ ¼å­

å¸ƒå±€çš„ CSS å°±æ˜¯å¦‚ä¸‹ï¼š

```css
body {
  background: #0f0e18;
  /* è®©æ•´ä¸ªå†…å®¹å‰§ä¸­ */
  display: flex;
  flex-direction: column;
  align-items: center;
}
.cell {
  display: inline-block;
  line-height: 7px;
  width: 6px;
  height: 6px;
  background-color: #2d2f42;
  border-bottom: solid 1px #0f0e18;
  border-right: solid 1px #0f0e18;
  vertical-align: bottom;
  transition: all 400ms ease;
}
#container {
  padding-bottom: 1rem;
  display: flex;
  flex-wrap: wrap;
  width: 701px;
}

/* ä¸ºäº†æ›´å¥½çœ‹ï¼ŒåŠ å…¥äº† button çš„æ ·å¼ï¼Œå¯æœ‰å¯æ— ï¼*/
button {
  background: transparent;
  /* border: none; */
  color: var(--blue-color);
  border: 1px solid aqua;
  padding: 0.5rem 1rem;
  cursor: pointer;
  transition: all 400ms ease;
}
button:hover {
  background: var(--blue-color);
  color: #333;
}
```

ä»¥ä¸Šæ˜¯å¸ƒå±€çš„ CSSï¼Œä½†æ˜¯æ•´ä¸ªåº•ç›˜æ˜¯éœ€è¦æˆ‘ä»¬ç”¨æ•°æ®æ¥æ„å»ºçš„ï¼Œè¿™æ ·æˆ‘ä»¬åé¢æ‰èƒ½ä½¿ç”¨å®ƒæ¥åšæˆ‘ä»¬å¯»è·¯çš„é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦åŠ å…¥ JavaScript æ¥åšæ•´ä¸ªæ¸²æŸ“çš„è¿‡ç¨‹ã€‚

HTML çš„éƒ¨åˆ†æˆ‘ä»¬åªéœ€è¦åŠ å…¥ä¸€ä¸ª `div`ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€ä¸ª ID ä¸º `container` å³å¯ï¼š

```html
<div id="container"></div>
```

## **å®ç°æ€è·¯**ï¼š

1. åˆ›å»ºä¸€ä¸ª 10000 ä¸ªæ•°æ®çš„æ•°ç»„ï¼Œå¹¶ä¸”ç»™é‡Œé¢éƒ½æ”¾å…¥ `0`
2. ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œå¾ªç¯éå†æ‰€æœ‰åº•ç›˜çš„æ ¼å­
3. åœ¨éå†çš„åŒæ—¶åœ¨åˆ›å»º `div` å…ƒç´ ï¼Œ`class` ä¸º `cell`
4. éå†çš„è¿‡ç¨‹ä¸­é‡åˆ°å€¼ä¸º `1` çš„å°±ç»™äºˆèƒŒæ™¯é¢œè‰² `#7ceefc`
5. æ·»åŠ  `mousemove` (é¼ æ ‡ç§»åŠ¨) ç›‘å¬
6. é¼ æ ‡ç§»åŠ¨ç›‘å¬ä¸­æœ‰ä¸¤ç§æƒ…å†µï¼Œå¦‚æœæ˜¯é¼ æ ‡å·¦é”®ç‚¹å‡»çŠ¶æ€ä¸‹å°±åŠ å…¥èƒŒæ™¯é¢œè‰²ï¼Œå¦‚æœæ˜¯å³é”®ç‚¹å‡»çš„è¯å°±æ˜¯æ¸…æ¥šå½“å‰èƒŒæ™¯é¢œè‰²
7. æœ€åæŠŠä½¿ç”¨ `appendChild` æŠŠ`cell` åŠ å…¥åˆ° `container` ä¹‹ä¸­
8. ä½¿ç”¨ localStorage è®°å½•æˆ‘ä»¬çš„åº•ç›˜æ•°æ®

## **ä»£ç å®ç°**ï¼š

```javascript
// å®šä¹‰ 100 x 100 çš„åº•ç›˜æ•°æ®
// ä½¿ç”¨ localStorage è·å–ï¼Œå¦‚æœæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ª
let map = localStorage['map'] ? JSON.parse(localStorage['map']) : Array(10000).fill(0);

// è·å– container å…ƒç´ å¯¹è±¡
let container = document.getElementById('container');

// éå†æ‰€æœ‰æ ¼å­
for (let y = 0; y < 100; y++) {
  for (let x = 0; x < 100; x++) {
    // åˆ›å»ºåœ°å›¾æ–¹æ ¼
    let cell = document.createElement('div');
    cell.classList.add('cell');
    // é‡åˆ°æ ¼å­çš„çŠ¶æ€æ˜¯ 1 çš„ï¼Œå°±èµ‹äºˆèƒŒæ™¯é¢œè‰²
    if (map[100 * y + x] == 1) cell.style.backgroundColor = 'aqua';
    // æ·»åŠ é¼ æ ‡ç§»åŠ¨ç›‘å¬äº‹ä»¶
    cell.addEventListener('mousemove', () => {
      // åªæœ‰åœ¨é¼ æ ‡ç‚¹å‡»çŠ¶æ€ä¸‹æ‰§è¡Œ
      if (mousedown) {
        if (clear) {
          // 1. å³é”®ç‚¹å‡»æ—¶ï¼Œå°±æ˜¯æ¸…æ¥šæ ¼å­çš„çŠ¶æ€
          cell.style.backgroundColor = '';
          map[100 * y + x] = 0;
        } else {
          // 2. å·¦é”®ç‚¹å‡»æ—¶ï¼Œå°±æ˜¯ç”»å…¥æ ¼å­çš„çŠ¶æ€
          cell.style.backgroundColor = 'aqua';
          map[100 * y + x] = 1;
        }
      }
    });
    // åŠ å…¥åˆ° container ä¹‹ä¸­
    container.appendChild(cell);
  }
}

let mousedown = false;
let clear = false;

// é¼ æ ‡æŒ‰é”®ç‚¹å‡»æ—¶ï¼ŒæŠŠé¼ æ ‡ç‚¹å‡»çŠ¶æ€å˜ä¸º true
document.addEventListener('mousedown', e => {
  mousedown = true;
  clear = e.which === 3;
});
// ç¦»å¼€ç‚¹å‡»é¼ æ ‡æŒ‰é”®åï¼ŒæŠŠçŠ¶æ€æ›´å˜æˆ false
document.addEventListener('mouseup', () => (mousedown = false));
// å› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨å³é”®ï¼Œæ‰€ä»¥è¦æŠŠå³é”®é»˜è®¤æ‰“å¼€èœå•ç¦ç”¨
document.addEventListener('contextmenu', e => e.preventDefault());
```

æœ€åæˆ‘ä»¬è¿™é‡Œæ·»åŠ ä¸€ä¸ªä¿å­˜æŒ‰é’®ï¼Œè®©æˆ‘ä»¬åˆ·æ–°é¡µé¢çš„æ—¶å€™ä¹Ÿä¼šä¿å­˜ç€æˆ‘ä»¬ç¼–è¾‘è¿‡çš„åœ°å›¾ï¼š

```html
<div id="container"></div>
<!-- ä¿å­˜åœ°å›¾æ•°æ®åˆ° localStorage -->
<button onclick="localStorage['map'] = JSON.stringify(map)">save</button>
```

æœ€åå‘ˆç°çš„ç»“æœå°±æ˜¯è¿™æ ·çš„ï¼š

![](https://img-blog.csdnimg.cn/20200928191540743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RyaURpYW1vbmQ2,size_16,color_FFFFFF,t_70#pic_center)

> [æŸ¥çœ‹æ•ˆæœ](http://tridiamond.tech/frontend-tutorials/exercises/path-finder/1-map-editor.html) ï½œ [æŸ¥çœ‹ä»£ç ](https://github.com/TriDiamond/frontend-tutorials/blob/master/exercises/path-finder/1-map-editor.html) ï½œ **å–œæ¬¢çš„åŒå­¦ ğŸŒŸstar ä¸€ä¸‹è°¢è°¢ï¼**

# å®ç°å¹¿åº¦ä¼˜å…ˆæœç´¢

ç°åœ¨æˆ‘ä»¬æ¥æ·±å…¥çš„è§£å†³å¯»è·¯çš„é—®é¢˜ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»å®šä¹‰è¿‡å¯»è·¯é—®é¢˜ï¼Œå°±æ˜¯ â€œ`æ‰¾åˆ°ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ‰¾ä¸€æ¡è·¯å¾„ï¼Œå¯ä»¥ä»èµ·ç‚¹åˆ°è¾¾ç»ˆç‚¹ï¼Œå¹¶ä¸”ä¸èƒ½è¶Šè¿‡æˆ‘ä»¬çš„è¾¹ç•Œå’Œå¢™`â€ã€‚

æˆ‘ä»¬ä¸€çœ¼çœ‹è¿‡å»è¿™ä¸ª 100 x 100 çš„ç½‘æ ¼ï¼Œç¡®å®ä¼šè§‰å¾—è¿™ä¸ªé—®é¢˜ä¸æ˜¯ç‰¹åˆ«åœ°å¥½è§£å†³ã€‚åœ¨ç®—è¿™ä¸ªè·¯å¾„çš„è¿‡ç¨‹ï¼Œä¸­é—´æœ‰å¤§é‡çš„æ•°æ®éœ€è¦æˆ‘ä»¬å»è¿ç®—ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜å˜å¾—æ›´ç®€å•ä¸€ç‚¹ã€‚

æˆ‘ä»¬ä¼šåˆ°èµ·ç‚¹ï¼Œä»èµ·ç‚¹è¿™ä¸ªä½ç½®å¼€å±•æˆ‘ä»¬çš„æ€è€ƒã€‚é—®ä¸€ä¸‹æˆ‘ä»¬è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šâ€ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥èµ°åˆ°å“ªé‡Œå‘¢ï¼Ÿâ€œ

è¿™é‡Œæˆ‘ä»¬é—®é¢˜è¿˜æ˜¯ä¸ç®€å•ï¼Œå¯ä»¥èµ°çš„åœ°æ–¹å¯å¤šäº†ã€‚å› ä¸ºèµ·ç‚¹çš„ä½ç½®å¯èƒ½æ²¡æœ‰ä»»ä½•éšœç¢ç‰©ï¼Œä¹Ÿä¸å†ä»»ä½•è¾¹ç¼˜ä¸Šã€‚é‚£å°±æ˜¯è¯´å“ªé‡Œéƒ½å¯ä»¥å‘€ï¼Ÿ

![](https://img-blog.csdnimg.cn/20200826170415899.gif#pic_center)

å¥½å§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æŠŠé—®é¢˜çš„èŒƒå›´å†ç¼©çª„ä¸€ç‚¹ï¼Œâ€œæˆ‘ä»¬ä»èµ·ç‚¹å¼€å§‹ï¼Œ`ç¬¬ä¸€æ­¥`èƒ½èµ°åˆ°å“ªé‡Œå‘¢ï¼Ÿâ€ã€‚å¥½è¿™ä¸ªé—®é¢˜çš„å…³é”®å°±æ˜¯`ç¬¬ä¸€æ­¥`ã€‚

å‡è®¾æˆ‘ä»¬å¿½ç•¥æ–œç€èµ°çš„æƒ…å†µï¼ˆè¿™ä¸ªæˆ‘ä»¬åé¢å†è€ƒè™‘è¿›å»ï¼Œè¿™é‡Œçš„ç»ˆç‚¹æ˜¯ç®€åŒ–é—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥èµ°å¾€`ä¸Š`ï¼Œ`ä¸‹`ï¼Œ`å·¦`ï¼Œ`å³` 4 ä¸ªæ ¼å­ã€‚å¦‚æœæˆ‘ä»¬é€†æ—¶é’ˆçš„ç»™è¿™äº›ä½ç½®æ ‡è®°ä¸€ä¸‹å°±ä¼šå¾—å‡ºä¸€ä¸‹çš„è·¯å¾„æ ‡è®°ã€‚

![](https://img-blog.csdnimg.cn/2020092819344460.png#pic_center)

å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯»è·¯çš„ç¬¬ä¸€æœ¬æ­¥éª¤äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä¸‹ä¸€æ­¥æˆ‘ä»¬åˆèƒ½èµ°åˆ°å“ªé‡Œã€‚å¦‚æœä¸Šé¢æ ‡è®°çš„`1`ï¼Œ`2`ï¼Œ`3`ï¼Œ`4` éƒ½æ˜¯å¯ä»¥èµ°çš„ï¼ŒæŒ‰ç…§æˆ‘ä»¬åˆšåˆšçš„æ€è·¯ï¼Œæˆ‘ä»¬ç°åœ¨çœ‹ `1` å·æ ¼å­åˆèƒ½èµ°å“ªé‡Œå‘¢ï¼Ÿ

![](https://img-blog.csdnimg.cn/20200928194257598.png#pic_center)

æ²¡æœ‰é”™ï¼ŒæŒ‰ç…§é€†æ—¶é’ˆçš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥èµ°çš„æ ¼å­æœ‰ `5`ï¼Œ`6`ï¼Œ`7` ä¸‰ä¸ªæ ¼å­ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿™æ ·çš„èµ°æ³•ï¼ŒæŠŠ`2`ï¼Œ`3`ï¼Œ`4` éƒ½èµ°ä¸€éã€‚æœ€åæˆ‘ä»¬å°±ä¼šå‘ç°ä¸‹é¢è¿™æ ·çš„è·¯å¾„ï¼š

![](https://img-blog.csdnimg.cn/20200929011003158.png#pic_center)

æœ€åæˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„åŠ¨ç”»æ•ˆæœï¼Œçœ‹çœ‹æ•´ä¸ªè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ã€‚

![](https://img-blog.csdnimg.cn/20200928163913547.gif#pic_center)

æ‰€ä»¥æˆ‘ä»¬å°±æ˜¯è¿™æ ·ï¼Œä¸€ç›´å¾€å¤–å¯»æ‰¾æˆ‘ä»¬å¯ä»¥èµ°åˆ°å“ªäº›æ ¼å­ï¼Œç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°æˆ‘ä»¬çš„ç»ˆç‚¹ã€‚è¿™æ ·å³å¯å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯çº¿ã€‚å½“ç„¶åœ¨å¯»æ‰¾çš„æ—¶å€™å¦‚æœæˆ‘ä»¬é‡åˆ°è¾¹ç•Œæˆ–è€…éšœç¢çš„æ—¶å€™å°±ä¼šè·³è¿‡ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯èµ°ä¸è¿‡å»çš„ã€‚

> è¿™ä¸ªæ€è·¯çš„é—®é¢˜ï¼Œå¾ˆå®¹æ˜“è®©å¤§å®¶æƒ³åˆ°é€’å½’ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•å¹¶ä¸é€‚åˆä½¿ç”¨é€’å½’æ¥è¡¨è¾¾ã€‚å¦‚æœæˆ‘ä»¬ç”¨é€’å½’æ¥è¡¨è¾¾ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯ä»æ‰¾åˆ° `1` è¿™ä¸ªæ ¼å­ä¹‹åï¼Œå°±ä¼šå¼€å§‹å±•å¼€æ‰¾ `1` å‘¨å›´çš„æ ¼å­äº†ã€‚é‚£ä¹ˆ 5ï¼Œ6ï¼Œ7 å°±ä¼šåœ¨ 2ï¼Œ3ï¼Œ4 ä¹‹å‰è¢«æ‰§è¡Œäº†ï¼ˆå› ä¸ºæ˜¯é€’å½’ï¼Œæˆ‘ä»¬ä¼šé€å±‚å±•å¼€çš„ï¼‰ã€‚

> æ‰€ä»¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬é»˜è®¤ç”¨é€’å½’çš„æ–¹å¼æ¥è¡¨è¾¾ï¼Œè¿™ä¸ªå¯»è·¯çš„æ–¹å¼å°±ä¼šå˜æˆ â€œ`æ·±åº¦ä¼˜å…ˆæœç´¢`â€ï¼Œä½†æ˜¯å¯¹å¯»è·¯é—®é¢˜æ¥è¯´æ·±åº¦ä¼˜å…ˆæœç´¢æ˜¯ä¸å¥½çš„ï¼Œâ€œ`å¹¿åº¦ä¼˜å…ˆæœç´¢`â€æ‰æ˜¯å¥½çš„ã€‚

## **ä¸ºä»€ä¹ˆå¯»è·¯å¹¿åº¦ä¼˜å…ˆæœç´¢æ¯”æ·±åº¦ä¼˜å…ˆæœç´¢å¥½å‘¢ï¼Ÿ**

æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼Œå°±æ›´å¥½ç†è§£äº†ï¼

![](https://img-blog.csdnimg.cn/20200826164747158.gif#pic_center)

> å‡è®¾æˆ‘ä»¬ç°åœ¨èµ°å…¥äº†ä¸€ä¸ªè¿·å®«ï¼Œå‰æ–¹æœ‰æˆåƒä¸Šä¸‡ä¸ªåˆ†å‰å£ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æœ‰ä¸¤ç§æœç´¢å‡ºè·¯çš„æ–¹æ³•

**æ–¹æ¡ˆä¸€**ï¼š

ç‹¬è‡ªä¸€äººï¼Œé€‰æ‹©å·¦è¾¹æˆ–è€…å³è¾¹ä¸€ç›´èµ°é‚£è¾¹çš„æ¯ä¸€æ¡åˆ†æ”¯ï¼Œå¹¶ä¸”éƒ½ä¸€ç›´èµ°åˆ°åº•ç›´åˆ°èµ°åˆ°æœ‰æ­»èƒ¡åŒäº†ï¼Œç„¶åå°±å›å¤´èµ°å¦å¤–é‚£è¾¹çš„åˆ†æ”¯ã€‚å°±è¿™æ ·ä¸€ç›´èµ°ä¸€ç›´åˆ‡æ¢åˆ†æ”¯ï¼Œç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°å‡ºå£çš„åˆ†æ”¯ä¸ºæ­¢ã€‚è¿æ°”å¥½çš„è¯ï¼Œå¾ˆå¿«å°±æ‰¾åˆ°å‡ºå£äº†ï¼Œè¿æ°”ä¸å¥½çš„è¯ï¼Œæ‰€æœ‰åˆ†æ”¯éƒ½åŸºæœ¬èµ°ä¸ªéæ‰èƒ½æ‰¾åˆ°å‡ºå£ã€‚

**æ–¹æ¡ˆäºŒ**ï¼š

æˆ‘ä»¬æ˜¯ç‹¬è‡ªä¸€ä¸ªäººï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰ â€œåˆ†èº«æœ¯â€ï¼Œå½“æˆ‘ä»¬é‡åˆ°åˆ†å‰å£çš„æ—¶å€™æˆ‘ä»¬æ˜¯å¯ä»¥æ¯ä¸€ä¸ªåˆ†å‰å£éƒ½å»å°è¯•ä¸€éã€‚æ¯”å¦‚ Aï¼ŒBï¼ŒC ä¸‰ä¸ªåˆ†å‰å£ï¼Œæˆ‘ä»¬å¯ä»¥ A è·¯çº¿èµ°ä¸€æ­¥ï¼Œç„¶å B è·¯çº¿ä¹Ÿèµ°ä¸€æ­¥ï¼Œæœ€å C è·¯çº¿ä¹Ÿèµ°ä¸€æ­¥ï¼Œè¿™é‡Œæˆ‘ä»¬æ­¥ä¼æ•´é½ç»Ÿä¸€ï¼Œå°±æœ‰ç‚¹åƒæˆ‘ä»¬ä¸Šé¢çš„åŠ¨æ€å›¾ä¸­ä¸€æ ·ï¼Œä¸€ç›´å¾€æ‰€æœ‰åˆ†å‰å£å¾€å¤–æ‰©å±•å¯»æ‰¾è·¯çº¿ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ N ä¸ªåˆ†å‰å£ä¾æ¬¡ä¸€æ­¥ä¸€æ­¥å¾€å‰èµ°ï¼Œç›´åˆ°æ‰¾åˆ°å‡ºå£ã€‚è¿™æ ·çš„æ–¹å¼ç­‰åŒäºæˆ‘ä»¬ä¾æ¬¡çš„åœ¨å¯»æ‰¾æ¯ä¸€ä¸ªåˆ†å‰å£ï¼Œè¿™æ ·çš„æœç´¢æ˜¾ç„¶æ˜¯æ¯”ç¬¬ä¸€ä¸ªå¥½çš„ã€‚ï¼ˆ**æˆ‘ä¸çŸ¥é“ä½ ä»¬ï¼Œä½†æ˜¯å°±æœ‰åˆ†èº«æœ¯è¿™ä¸ªæŠ€èƒ½æˆ‘å°±è§‰å¾—å·²ç»åœ¨å¯»è·¯è¿™ä¸ªé—®é¢˜ä¸­èµ¢äº†ï¼**ï¼‰

![](https://img-blog.csdnimg.cn/20200929014054873.gif#pic_center)

> å›å½’åˆ°ç®—æ³•çš„è¯ï¼Œ**æ–¹æ¡ˆä¸€**å…¶å®å°±æ˜¯â€œ`æ·±åº¦ä¼˜å…ˆæœç´¢`â€ï¼Œè€Œ**æ–¹æ¡ˆäºŒ**å°±æ˜¯"`å¹¿åº¦ä¼˜å…ˆæœç´¢`"ï¼æ˜¾ç„¶åœ¨å¯»è·¯è¿™ç§é—®é¢˜æ˜¯å¹¿åº¦ä¼˜å…ˆæœç´¢æ›´ä¸ºé«˜æ•ˆï¼

## å®ç°å¹¿åº¦ä¼˜å…ˆæœç´¢ä»£ç 

ç©è¿‡èµ°è¿·å®«çš„åŒå­¦è‚¯å®šéƒ½ä¼šæƒ³åˆ°ï¼Œåœ¨èµ°è¿·å®«çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šç»™æˆ‘ä»¬èµ°è¿‡çš„è·¯å¾„æ ‡è®°ï¼Œè¿™æ ·æˆ‘ä»¬æ‰çŸ¥é“æˆ‘ä»¬èµ°è¿‡å“ªé‡Œï¼Œæœ€åé€šè¿‡è¿™äº›è®°å½•æ‰¾åˆ°å¯ä»¥åˆ°è¾¾ç»ˆç‚¹çš„è·¯å¾„ã€‚æˆ‘ä»¬è¿™ä¸ªå¯»è·¯çš„é—®é¢˜ä¹Ÿä¸ä¾‹å¤–ï¼Œæ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬ä»èµ·ç‚¹å°±å¼€å§‹å¾€å¤–æ‰©å±•å¯»æ‰¾å¯ä»¥èµ°çš„æ ¼å­ï¼Œæ¯å½“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå¯èµ°çš„æ ¼å­ï¼Œæˆ‘ä»¬éƒ½éœ€è¦è®°å½•èµ·æ¥ã€‚

åœ¨ç®—æ³•å½“ä¸­æˆ‘ä»¬éƒ½ä¼šæŠŠæ•°æ®åŠ å…¥ä¸€ä¸ª â€œ`é›†åˆ`â€ é‡Œé¢ï¼Œè€Œè¿™ä¸ªé›†åˆå°±æ˜¯æ‰€æœ‰æœç´¢ç®—æ³•çš„ â€œ`çµé­‚`â€ã€‚æ‰€æœ‰æœç´¢ç®—æ³•çš„å·®å¼‚ï¼Œå®Œå…¨å°±æ˜¯åœ¨äºè¿™ä¸ª â€œ`é›†åˆ (queue)`â€ é‡Œé¢ã€‚

è€Œ `queue` æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¹Ÿå«å®ƒä¸º â€œ`é˜Ÿåˆ—`â€ï¼Œå®ƒçš„ç‰¹æ€§å°±æ˜¯ `å…ˆè¿›å…ˆå‡º` ï¼Œ`ä¸€è¾¹è¿›å¦å¤–ä¸€è¾¹å‡º`ã€‚å®é™…æ•ˆæœä¸ä¸‹å›¾ï¼š

![](https://img-blog.csdnimg.cn/20200929020713965.gif#pic_center)

é‚£ä¹ˆ JavaScript ä¸­æœ‰æ²¡æœ‰é˜Ÿåˆ—è¿™æ ·çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿæœ‰ï¼`JavaScript ä¸­çš„æ•°ç»„å°±æ˜¯å¤©ç„¶çš„é˜Ÿåˆ— (Queue)`ï¼ŒåŒæ—¶ `JavaScript ä¸­çš„æ•°ç»„ä¹Ÿæ˜¯å¤©ç„¶çš„æ ˆ (Stack)`ã€‚

![](https://img-blog.csdnimg.cn/20200826170415899.gif#pic_center)

JavaScript çš„æ•°ç»„æœ‰ 2 ç»„å¸¸ç”¨çš„å¤„ç†æ–¹æ³• `shif` å’Œ `unshift`ï¼Œä»¥åŠ `push` å’Œ `pop`ã€‚ ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ··æ­æ¥ä½¿ç”¨ä»–ä»¬çš„è¯ï¼Œå°±ä¼šè®©æˆ‘ä»¬çš„æ•°ç»„å˜æˆä¸ä¸€æ ·çš„æ•°æ®ç»“æ„ã€‚

- `push` ä¸ `shift` æˆ–è€… `pop` ä¸ `unshift` ç»“åˆä½¿ç”¨ï¼Œé‚£ä¹ˆæ•°ç»„å°±æ˜¯ä¸€ä¸ª`é˜Ÿåˆ— (Queue)`
- `push` å’Œ `pop` ç»“åˆä½¿ç”¨é‚£ä¹ˆï¼Œæ•°ç»„å°±æ˜¯ä¸€ä¸ª`æ ˆ (Stack)` ï¼ˆå½“ç„¶ shif å’Œ unshif ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç”¨è¿™ä¸ªç»„åˆæ¥åšæ ˆï¼Œå› ä¸ºæˆ‘ä»¬è€ƒè™‘åˆ° JavaScript çš„æ•°ç»„çš„å®ç°ï¼Œè¿™æ ·ä½¿ç”¨æ€§èƒ½ä¼šå˜ä½ã€‚ï¼‰

è¿™äº›ç†è®ºçŸ¥è¯†éƒ½ææ‡‚äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ•´ç†ä¸€ä¸‹ç¼–å†™ä»£ç çš„æ€è·¯äº†ï¼š

1. æˆ‘ä»¬éœ€è¦å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯å£°æ˜ä¸€ä¸ª `queue`ï¼Œå¹¶ä¸”æŠŠæˆ‘ä»¬çš„èµ·ç‚¹é»˜è®¤æ”¾å…¥é˜Ÿåˆ—ä¸­ã€‚ï¼ˆJavaScript ä¸­æˆ‘ä»¬ä½¿ç”¨æ•°ç»„å³å¯ï¼‰
2. ç¼–å†™ä¸€ä¸ª â€œå…¥é˜Ÿâ€ çš„æ–¹æ³•ï¼Œæ¡ä»¶æ˜¯å¦‚æœé‡åˆ°è¾¹ç¼˜æˆ–è€…éšœç¢å°±ç›´æ¥è·³å‡ºæ–¹æ³•ï¼Œè¿™äº›éƒ½æ˜¯ä¸å¯èµ°çš„æ ¼å­æ‰€ä»¥ä¸ä¼šåŠ å…¥æˆ‘ä»¬çš„é˜Ÿåˆ—ã€‚
3. å¦‚æœæ²¡æœ‰é‡åˆ°ä»¥ä¸Šæƒ…å†µï¼Œæˆ‘ä»¬å°±å¯ä»¥å…ˆæŠŠå¯ä»¥èµ°çš„æ ¼å­åœ¨æˆ‘ä»¬çš„ `map`ï¼ˆåœ¨å®ç°æˆ‘ä»¬çš„åœ°å›¾æ•°æ®çš„æ—¶å€™å£°æ˜çš„ä¸€ä¸ªæ•°ç»„ï¼‰ä¸­è®°å½•ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `2`ï¼Œ ä»£è¡¨è¿™ä¸ªæ ¼å­æˆ‘ä»¬å·²ç»èµ°è¿‡äº†ï¼Œè¿™é‡Œæˆ‘ä»¬åŠ å…¥ä¸€ä¸ªæ ‡è®°ã€‚
4. å¾ªç¯æˆ‘ä»¬é˜Ÿåˆ—ä¸­å¯ä»¥èµ°çš„æ ¼å­ï¼Œè¿™é‡Œçš„ä¸»è¦ç›®æ ‡å°±æ˜¯æŠŠæ‰€æœ‰è®°å½•äº†å¯ä»¥èµ°çš„æ ¼å­éƒ½æ‰¾åˆ°å®ƒçš„ `ä¸Š`ï¼Œ`ä¸‹`ï¼Œ`å·¦`ï¼Œ`å³`ï¼Œå¹¶ä¸”æŠŠè¿™äº›å¯èµ°çš„æ ¼å­éƒ½å…¥é˜Ÿåˆ—ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ—¶å°±ä¼šå»æ‰¾è¿™äº›æ–°å…¥é˜Ÿåˆ—çš„æ ¼å­å¯ä»¥èµ°åˆ°å“ªé‡Œï¼Œç„¶åæŠŠåé¢æ‰¾åˆ°çš„æ ¼å­å†æ¬¡å…¥é˜Ÿåˆ—ï¼Œä»¥æ­¤ç±»æ¨ã€‚
5. è¿™ä¸ªå¾ªç¯æœ‰ä¸€ä¸ªæˆªæ­¢æ¡ä»¶ï¼Œé‚£å°±æ˜¯å¦‚æœæˆ‘ä»¬åœ¨å¾ªç¯æ¯ä¸ªæ ¼å­çš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†ç»ˆç‚¹çš„æ ¼å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¿”å› `true`ï¼Œä»£è¡¨æˆ‘ä»¬å·²ç»æ‰¾åˆ°ç»ˆç‚¹äº†ã€‚

å¥½æ€è·¯åˆäº†ï¼Œæˆ‘ä»¬é©¬ä¸Šæ¥çœ‹çœ‹ä»£ç å®ç°ï¼š

```javascript
// ä¸Šä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œå°±å¿½ç•¥äº†...
// åªè¦åœ¨ä¸Šéƒ¨åˆ†çš„ä»£ç åé¢æ”¹é€ è¿™éƒ¨åˆ†å³å¯

// ç¦»å¼€ç‚¹å‡»é¼ æ ‡æŒ‰é”®åï¼ŒæŠŠçŠ¶æ€æ›´å˜æˆ false
document.addEventListener('mouseup', () => (mousedown = false));
// å› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨å³é”®ï¼Œæ‰€ä»¥è¦æŠŠå³é”®é»˜è®¤æ‰“å¼€èœå•ç¦ç”¨
document.addEventListener('contextmenu', e => e.preventDefault());

/**
 * å¯»è·¯æ–¹æ³•
 * @param {Array} map åœ°å›¾æ•°æ®
 * @param {Array} start èµ·ç‚¹ ä¾‹å¦‚ï¼š[0, 0]
 * @param {Array} end ç»ˆç‚¹ ä¾‹å¦‚ï¼š[50, 50]
 * @return Boolean
 */
function path(map, start, end) {
  var queue = [start];

  function insert(x, y) {
    // åˆ°è¾¾åº•ç›˜è¾¹ç¼˜ï¼Œç›´æ¥åœæ­¢
    if (x < 0 || x >= 100 || y < 0 || y >= 100) return;
    // é‡åˆ°åœ°å›¾çš„å¢™ï¼Œä¹Ÿåœæ­¢
    if (map[y * 100 + x]) return;
    // æ ‡è®°å¯ä»¥èµ°çš„è·¯çš„æ ¼å­çš„çŠ¶æ€ä¸º 2
    map[y * 100 + x] = 2;
    // æŠŠå¯èµ°çš„è·¯æ¨å…¥é˜Ÿåˆ—
    queue.push([x, y]);
  }

  // å¾ªç¯æ ¼å­ 4 è¾¹çš„æ ¼å­
  while (queue.length) {
    let [x, y] = queue.shift();
    console.log(x, y);

    // é‡åˆ°äº†ç»ˆç‚¹ä½ç½®å°±å¯ä»¥è¿”å›äº†
    if (x === end[0] && y === end[1]) return true;

    // æŠŠä¸Šä¸‹å·¦å³æ¨å…¥é˜Ÿåˆ—
    insert(x - 1, y);
    insert(x, y - 1);
    insert(x + 1, y);
    insert(x, y + 1);
  }

  return false;
}
```

ä¸ºäº†å¯ä»¥è°ƒè¯•çœ‹çœ‹ï¼Œæˆ‘ä»¬çš„ä»£ç æ˜¯å¦æ­£ç¡®ï¼Œæˆ‘ä»¬æ¥åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œå¹¶ä¸”è®©å®ƒå¯ä»¥æ‰§è¡Œæˆ‘ä»¬è¿™ä¸ªå¯»è·¯çš„æ–¹æ³• `path`ã€‚

```html
<div id="container"></div>
<!-- ä¿å­˜åœ°å›¾æ•°æ®åˆ° localStorage -->
<div>
  <button onclick="localStorage['map'] = JSON.stringify(map)">save</button>
  <button onclick="path(map, [0,0], [50,50])">find</button>
</div>
```

> è¿™é‡Œæˆ‘ä»¬çš„æŒ‰é’®ä¼šæ‰§è¡Œä¸€ä¸ªå¯»è·¯æ–¹æ³•ï¼Œè®¾ç½®äº†èµ·ç‚¹æ˜¯ x = 0ï¼Œy = 0 çš„ä½ç½®ï¼Œç»ˆç‚¹æ˜¯ x = 50ï¼Œy = 50 çš„ä½ç½®ã€‚ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨çš„è°ƒè¯•å·¥å…·ä¸­çš„ `console` ä¹‹ä¸­çœ‹åˆ°å¯»è·¯è¿‡ç¨‹ä¸­èµ°è¿‡çš„ x å’Œ yã€‚å¦‚æœæˆ‘ä»¬çš„ä»£ç æ˜¯å¯¹çš„è¯ï¼Œæœ€åæˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨ 50, 50 çš„æ—¶å€™å°±ä¼šåœæ­¢è¿è¡Œäº†ã€‚

> [æŸ¥çœ‹æ•ˆæœ](http://tridiamond.tech/frontend-tutorials/exercises/path-finder/2-map-path.html) ï½œ [æŸ¥çœ‹ä»£ç ](https://github.com/TriDiamond/frontend-tutorials/blob/master/exercises/path-finder/2-map-path.html) ï½œ **å–œæ¬¢çš„åŒå­¦ ğŸŒŸstar ä¸€ä¸‹è°¢è°¢ï¼**

# åŠ å…¥ Async å’Œ Await æ¥æ–¹ä¾¿è°ƒè¯•å’Œå±•ç¤º

ä¸Šä¸€ä¸ªä»£ç ä¸­ï¼Œå…¶å®å·²ç»å®ç°äº†å¯»è·¯ç®—æ³•çš„ä¸»ä½“éƒ¨åˆ†äº†ã€‚ä½†æ˜¯é‡Œé¢è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ï¼š

1. ç®—æ³•è™½ç„¶æœ€ç»ˆè¿”å›äº†æˆ‘ä»¬ç»ˆç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸”è¿”å›äº† `true`ï¼Œçœ‹èµ·æ¥æ˜¯ç¬¦åˆäº†æˆ‘ä»¬çš„é¢„æœŸçš„ã€‚ä½†æ˜¯å®ƒçš„æ­£ç¡®æ€§æˆ‘ä»¬ä¸å¤ªå¥½ä¿è¯ã€‚**æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªå¯è§†åŒ–çš„æ•ˆæœæ¥è§‚å¯Ÿè¿™ä¸ªå¯»è·¯ç®—æ³•çš„è¿‡ç¨‹**ã€‚
2. æˆ‘ä»¬æ˜¯æ‰¾åˆ°ä¸€æ¡è·¯å¾„ï¼Œ**è¿™ä¸ªæœ€ç»ˆçš„è·¯å¾„æˆ‘ä»¬è¿˜æ²¡æœ‰æŠŠå®ƒæ‰¾å‡ºæ¥**ã€‚

è¿™äº›é—®é¢˜æˆ‘ä»¬ä¸‹æ¥å‡ ä¸ªæ­¥éª¤ä¸­ä¼šä¸€æ­¥ä¸€æ­¥æ¥è§£å†³ã€‚

> å¦‚ä½•æœ‰çœ‹æˆ‘ä»¬çš„ ã€ŠTicTacToe ä¸‰å­æ£‹ã€‹çš„ç¼–ç¨‹ä¸ç®—æ³•ç»ƒä¹ çš„æ–‡ç« çš„è¯ï¼Œæˆ‘ä»¬é‡Œé¢æœ‰è®²åˆ°ä½¿ç”¨ `async` å’Œ `await` ï¼Œæ¥è®©å‡½æ•°ä¸­é—´å¯æ’å…¥ä¸€äº›å¼‚æ­¥çš„æ“ä½œã€‚

è¿™éƒ¨åˆ†çš„ä»£ç æˆ‘ä»¬åšäº†ä¸€äº›ä»£ç çš„æ”¹é€ ï¼š

1. æŠŠ `path()` å‡½æ•°æ”¹ä¸º `async` å‡½æ•°
2. æŠŠ `insert()` å‡½æ•°æ”¹ä¸º `async` å‡½æ•°
3. å› ä¸º `insert()` ç¼–ç¨‹äº†å¼‚æ­¥å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ `while()` å¾ªç¯ä¸­çš„ insert è°ƒç”¨éƒ½éœ€è¦åœ¨å‰é¢åŠ å…¥ `await`
4. åŒæ—¶æˆ‘ä»¬éœ€è¦åŠ å…¥ä¸€ä¸ªç­‰å¾…å‡½æ•°`sleep()`ï¼Œå®ƒå¿…é¡»è¿”å›ä¸€ä¸ª `promise`
5. åœ¨æˆ‘ä»¬å…¥é˜Ÿåˆ—ä¹‹åï¼Œåœ¨æ”¹å˜å½“å‰æ ¼å­çŠ¶æ€ä¸º `2` ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šå¯¹ DOM å…ƒç´ ä¸­çš„æ ¼å­çš„èƒŒæ™¯é¢œè‰²è¿›è¡Œæ”¹å˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å¯»è·¯çš„è¿‡ç¨‹
6. å› ä¸ºæˆ‘ä»¬éœ€è¦çœ‹åˆ°è¿™ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å…¥é˜Ÿåˆ—çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ª 1 ç§’çš„ç­‰å¾…æ—¶é—´ï¼Œè¿™ä¸ªå°±æ˜¯ä½¿ç”¨ `async` å’Œ `await` çš„å¥½å¤„ã€‚åœ¨åŠ å…¥è¿™ä¸ªèƒŒæ™¯é¢œè‰²ä¹‹å‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ å…¥ä¸€ä¸ª `await sleep(1)`ï¼Œè¿™æ ·å…¥é˜Ÿåˆ—å’Œæ”¹å˜æ ¼å­èƒŒæ™¯é¢œè‰²ä¹‹å‰å°±ä¼šæœ‰ 1 ç§’çš„å»¶è¿Ÿã€‚

å¥½åºŸè¯å°‘è¯´ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç æœ‰ä»€ä¹ˆå˜åŒ–ï¼š

```javascript
// ä¸Šä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œå°±å¿½ç•¥äº†...
// åªè¦åœ¨ä¸Šéƒ¨åˆ†çš„ä»£ç åé¢æ”¹é€ è¿™éƒ¨åˆ†å³å¯

// ç¦»å¼€ç‚¹å‡»é¼ æ ‡æŒ‰é”®åï¼ŒæŠŠçŠ¶æ€æ›´å˜æˆ false
document.addEventListener('mouseup', () => (mousedown = false));
// å› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨å³é”®ï¼Œæ‰€ä»¥è¦æŠŠå³é”®é»˜è®¤æ‰“å¼€èœå•ç¦ç”¨
document.addEventListener('contextmenu', e => e.preventDefault());

/**
 * ç­‰å¾…å‡½æ•°
 * @param {Integer} t æ—¶é—´ (ç§’)
 * @return Promise
 */
function sleep(t) {
  return new Promise(function (resolve) {
    setTimeout(resolve, t);
  });
}

/**
 * å¯»è·¯æ–¹æ³• (å¼‚æ­¥)
 * @param {Array} map åœ°å›¾æ•°æ®
 * @param {Array} start èµ·ç‚¹ ä¾‹å¦‚ï¼š[0, 0]
 * @param {Array} end ç»ˆç‚¹ ä¾‹å¦‚ï¼š[50, 50]
 * @return Boolean
 */
async function path(map, start, end) {
  var queue = [start];

  /**
   * å…¥é˜Ÿæ–¹æ³• (å¼‚æ­¥)
   * @param {Integer} x
   * @param {Integer} y
   */
  async function insert(x, y) {
    // åˆ°è¾¾åº•ç›˜è¾¹ç¼˜ï¼Œç›´æ¥åœæ­¢
    if (x < 0 || x >= 100 || y < 0 || y >= 100) return;
    // é‡åˆ°åœ°å›¾çš„å¢™ï¼Œä¹Ÿåœæ­¢
    if (map[y * 100 + x]) return;
    // åŠ å…¥ 30 æ¯«ç§’çš„åœé¡¿ï¼Œè®©æˆ‘ä»¬å¯ä»¥çœ‹åˆ° UI ä¸Šé¢çš„å˜åŒ–
    await sleep(1);
    // ç»™æœç´¢åˆ°çš„è·¯å¾„çš„æ ¼å­åŠ ä¸ŠèƒŒæ™¯é¢œè‰²
    container.children[y * 100 + x].style.backgroundColor = 'DARKSLATEBLUE';
    // æ ‡è®°å¯ä»¥èµ°çš„è·¯çš„æ ¼å­çš„çŠ¶æ€ä¸º 2
    map[y * 100 + x] = 2;
    // æŠŠå¯èµ°çš„è·¯æ¨å…¥é˜Ÿåˆ—
    queue.push([x, y]);
  }

  // å¾ªç¯æ ¼å­ 4 è¾¹çš„æ ¼å­
  while (queue.length) {
    let [x, y] = queue.shift();
    // console.log(x, y);

    // é‡åˆ°äº†ç»ˆç‚¹ä½ç½®å°±å¯ä»¥è¿”å›äº†
    if (x === end[0] && y === end[1]) return true;

    // æŠŠä¸Šä¸‹å·¦å³æ¨å…¥é˜Ÿåˆ—
    await insert(x - 1, y);
    await insert(x, y - 1);
    await insert(x + 1, y);
    await insert(x, y + 1);
  }

  return false;
}
```

æœ€åæˆ‘ä»¬æ‰§è¡Œåçš„ç»“æœï¼š

![](https://img-blog.csdnimg.cn/20200929034209607.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RyaURpYW1vbmQ2,size_16,color_FFFFFF,t_70#pic_center)

> [æŸ¥çœ‹æ•ˆæœ](http://tridiamond.tech/frontend-tutorials/exercises/path-finder/3-map-search-async.html) ï½œ [æŸ¥çœ‹ä»£ç ](https://github.com/TriDiamond/frontend-tutorials/blob/master/exercises/path-finder/3-map-search-async.html) ï½œ **å–œæ¬¢çš„åŒå­¦ ğŸŒŸstar ä¸€ä¸‹è°¢è°¢ï¼**

# å¤„ç†è·¯å¾„é—®é¢˜

ä¸Šä¸€æ­¥æˆ‘ä»¬ç”¨ä¸€ä¸ªåŠ¨ç”»ï¼Œè®©æˆ‘ä»¬ç‰¹åˆ«æ¸…æ™°çš„å»ç†è§£æ•´ä¸ªå¯»è·¯ç®—æ³•çš„è¿‡ç¨‹ã€‚ä½†æ˜¯ä¸Šä¸€æ­¥æåˆ°çš„ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç›®å‰æ˜¯è¿˜æ²¡æœ‰è§£å†³çš„ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±æ˜¯è¦æ‰¾åˆ°æœ€ç»ˆçš„è·¯å¾„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æœ€ç»ˆé€šè¿‡å¯»è·¯ç®—æ³•ä¹‹åï¼Œæˆ‘ä»¬æ€ä¹ˆè·å¾—ä¸€ä¸ªè·¯å¾„æ˜¯å¯ä»¥ä»èµ·ç‚¹åˆ°è¾¾ç»ˆç‚¹çš„å‘¢ï¼Ÿ

å…¶å®å¤„ç†è¿™ä¸ªè·¯å¾„çš„é—®é¢˜ä¹Ÿæ˜¯éå¸¸çš„ç®€å•çš„ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹çœ‹æˆ‘ä»¬ä¹‹å‰è®²è¿‡çš„å¯»è·¯çš„æ€è·¯ï¼š

![](https://img-blog.csdnimg.cn/20200929011003158.png#pic_center)

é€šè¿‡ä¸Šé¢è¿™ä¸ªå›¾ï¼Œæˆ‘ä»¬å·²ç»éƒ½è¿˜è®°å¾—ï¼Œåœ¨æˆ‘ä»¬è®¿é—®æ¯ä¸€ä¸ªæ ¼å­çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¾€å¤–æ‰©å±•æ‰¾åˆ°å¯èµ°çš„æ ¼å­æœ‰å“ªäº›ã€‚è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯çŸ¥é“æ¯ä¸€ä¸ªè¢«æ‰©å±•åˆ°çš„æ ¼å­éƒ½æ˜¯ç”±å‰ä¸€ä¸ªç»™è‡ªæ‰©å±•è¿‡æ¥çš„ã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸€ä¸ªæ ¼å­éƒ½æ˜¯çŸ¥é“æˆ‘ä»¬æ˜¯ä»é‚£ä¸ªç»™è‡ªæ‰©å±•è¿‡æ¥çš„ã€‚

æ¯”å¦‚è¯´ `5`ï¼Œ`6`ï¼Œ`7` è¿™ä¸‰ä¸ªæ ¼å­éƒ½æ˜¯ä» `1` è¿™ä¸ªæ ¼å­æ‰©å±•è¿‡æ¥çš„ã€‚æ—¢ç„¶æˆ‘ä»¬çŸ¥é“æ¯ä¸ªç»™è‡ªä¸Šä¸€æ­¥çš„æ¥æºï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€ä¸ªç»™è‡ªè®°å½•ä¸Šä¸€ä¸ªæ¥æºçš„æ ¼å­å‘¢ï¼Ÿæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥åœ¨å…¥é˜Ÿçš„æ—¶å€™ï¼Œå°±è®°å½•ä¸Šä¸€ä¸ªç»™è‡ªçš„ xï¼Œy è½´å‘¢ï¼Ÿ

> é‚£ä¹ˆæˆ‘ä»¬å°±äº§ç”Ÿä¸€ä¸ªæƒ³æ³•ï¼Œé€šè¿‡è¿™ä¸ªè®°å½•ï¼Œæˆ‘ä»¬æ€ä¹ˆå¯»æ‰¾æœ€ç»ˆçš„è·¯å¾„å‘¢ï¼Ÿ

æˆ‘ä»¬å‡è®¾ç»ˆç‚¹æ˜¯åœ¨ `8` è¿™ä¸ªä½ç½®ï¼Œæˆ‘ä»¬è¿‡æ¥ `8` è¿™ä¸ªç‚¹çš„æ—¶å€™æ˜¯ä»æˆ‘ä»¬çš„èµ·ç‚¹ä¸€æ­¥ä¸€æ­¥æ‰©å±•å‡ºæ¥çš„ï¼Œé‚£æˆ‘ä»¬åè¿‡æ¥é€šè¿‡è®°å½•äº†æ¯ä¸€ä¸ªæ ¼å­çš„å‰é©±æ ¼å­ï¼Œå°±å¯ä»¥ä¸€æ­¥ä¸€æ­¥æ”¶ç¼©å›åˆ°èµ·ç‚¹å‘¢ï¼Ÿ

é‚£å°±æ˜¯è¯´ï¼Œä» `8` å¼€å§‹æ”¶ï¼Œ`8` æ˜¯ä» `2` èµ°è¿‡æ¥çš„ï¼Œè€Œ `2` å°±æ˜¯ä»`èµ·ç‚¹` æ‰©å±•è¿‡æ¥çš„ï¼Œæœ€ç»ˆæˆ‘ä»¬å°±æ‰¾åˆ°èµ·ç‚¹äº†ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ”¶ç¼©çš„è¿‡ç¨‹è®°å½•ç€æ”¶ç¼©æ—¶å€™è®¿é—®åˆ°çš„æ ¼å­ï¼Œæœ€ç»ˆè¿™äº›æ ¼å­å°±æ˜¯ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æ•´æ¡è·¯å¾„äº†ï¼æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Ÿï¼

> å…¶å®ä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ª â€œåŸè·¯è¿”å›â€ çš„æ•ˆæœï¼

![](https://img-blog.csdnimg.cn/20200929040544273.gif#pic_center)

å…ˆä¸è¦é¸¡å†»ï¼Œç¨³ä½ï¼æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹ä»£ç æ˜¯å¦‚ä½•å¤„ç†çš„ï¼š

1. å…¶å®åŸºæœ¬ä¸Šæˆ‘ä»¬çš„ä»£ç æ²¡æœ‰å¤ªå¤šçš„æ”¹å˜
2. é¦–å…ˆå°±æ˜¯åœ¨ `while` å¾ªç¯å½“ä¸­çš„ `insert()` è°ƒç”¨çš„æ—¶å€™æ·»åŠ äº†ä¸Šä¸€ä¸ªåæ ‡çš„ä¼ å‚
3. è¿™é‡Œæˆ‘ä»¬é¡ºä¾¿ä¹ŸæŠŠæ¨ªå‘çš„å¯èµ°çš„æ ¼å­ä¹ŸåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­
4. è¿™é‡Œå› ä¸ºæˆ‘ä»¬éœ€è¦è®°å½•æ‰€æœ‰æ ¼å­çš„å‰é©±åæ ‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å£°æ˜ä¸€ä¸ª `table` çš„å˜é‡å­˜æ”¾è¿™ä¸ªæ•°æ®
5. åœ¨æˆ‘ä»¬è¿›å…¥é˜Ÿåˆ—ä¹‹å‰ï¼Œæˆ‘ä»¬å°±æŠŠå½“å‰å…¥é˜Ÿåˆ—çš„æ ¼å­çš„å€¼å­˜ä¸ºä¸Šä¸€ä¸ªæ ¼å­çš„åæ ‡ï¼ˆè¿™ä¸ªä¸ºäº†æˆ‘ä»¬åé¢æ–¹ä¾¿æ”¶ç¼©æ˜¯æ‰¾åˆ°æ•´ä¸ªè·¯å¾„ï¼‰
6. æœ€ååœ¨ `while` å¾ªç¯ä¸­ï¼Œå½“æˆ‘ä»¬é‡åˆ°ç»ˆç‚¹çš„ x å’Œ y çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŠ å…¥ä¸€æ®µ `while` å¾ªç¯
7. è¿™ä¸ª `while` å°±æ˜¯å¾€å›ä¸€ç›´èµ°ï¼ŒçŸ¥é“æˆ‘ä»¬æ‰¾åˆ°èµ·ç‚¹ä½ç½®ï¼Œåœ¨å¾€å›èµ°çš„åŒæ—¶ï¼ŒæŠŠæ¯ä¸€ä¸ªç»è¿‡çš„æ ¼å­çš„èƒŒæ™¯æ”¹ä¸ºå¦å¤–ä¸€ä¸ªèƒŒæ™¯é¢œè‰²ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„åœ°å›¾ä¸Šç”»å‡ºä¸€ä¸ªè·¯å¾„äº†ï¼

å¥½æ€è·¯æ¸…æ™°ï¼Œæˆ‘ä»¬æ¥ä¸Šä¸€æ³¢ä»£ç å§ï¼

```javascript
// ä¸Šä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œå°±å¿½ç•¥äº†...
// åªè¦åœ¨ä¸Šéƒ¨åˆ†çš„ä»£ç åé¢æ”¹é€ è¿™éƒ¨åˆ†å³å¯

/**
 * å¯»è·¯æ–¹æ³• (å¼‚æ­¥)
 * @param {Array} map åœ°å›¾æ•°æ®
 * @param {Array} start èµ·ç‚¹ ä¾‹å¦‚ï¼š[0, 0]
 * @param {Array} end ç»ˆç‚¹ ä¾‹å¦‚ï¼š[50, 50]
 * @return Boolean
 */
function sleep(t) {
  return new Promise(function (resolve) {
    setTimeout(resolve, t);
  });
}

/**
 * å…¥é˜Ÿæ–¹æ³• (å¼‚æ­¥)
 * @param {Integer} x
 * @param {Integer} y
 */
async function findPath(map, start, end) {
  // åˆ›å»ºä¸€ä¸ªè®°å½•è¡¨æ ¼
  let table = Object.create(map);
  let queue = [start];

  /**
   * å…¥é˜Ÿæ–¹æ³• (å¼‚æ­¥)
   * @param {Integer} x
   * @param {Integer} y
   * @param {Array} pre ä¸Šä¸€ä¸ªæ ¼å­çš„åæ ‡ï¼š[x,y]
   */
  async function insert(x, y, pre) {
    // åˆ°è¾¾åº•ç›˜è¾¹ç¼˜ï¼Œç›´æ¥åœæ­¢
    if (x < 0 || x >= 100 || y < 0 || y >= 100) return;
    // é‡åˆ°åœ°å›¾çš„å¢™ï¼Œä¹Ÿåœæ­¢
    if (table[y * 100 + x]) return;
    // åŠ å…¥ 30 æ¯«ç§’çš„åœé¡¿ï¼Œè®©æˆ‘ä»¬å¯ä»¥çœ‹åˆ° UI ä¸Šé¢çš„å˜åŒ–
    // await sleep(1);
    // ç»™æœç´¢åˆ°çš„è·¯å¾„çš„æ ¼å­åŠ ä¸ŠèƒŒæ™¯é¢œè‰²
    container.children[y * 100 + x].style.backgroundColor = 'DARKSLATEBLUE';
    // æ ‡è®°èµ°è¿‡çš„æ ¼å­çš„å€¼ï¼Œæ ‡è®°ä¸ºä¸Šä¸€ä¸ªæ ¼å­çš„ xï¼Œy ä½ç½®
    table[y * 100 + x] = pre;
    // æŠŠå¯èµ°çš„è·¯æ¨å…¥é˜Ÿåˆ—
    queue.push([x, y]);
  }

  // å¾ªç¯æ ¼å­ 4 è¾¹çš„æ ¼å­
  while (queue.length) {
    let [x, y] = queue.shift();
    // console.log(x, y);

    // é‡åˆ°äº†ç»ˆç‚¹ä½ç½®å°±å¯ä»¥è¿”å›äº†
    if (x === end[0] && y === end[1]) {
      let path = [];

      // å¾€å›èµ°ï¼Œç›´åˆ°èµ°åˆ°èµ·ç‚¹
      // è¿™æ ·å°±èƒ½ç”»å‡ºæœ€ä½³è·¯å¾„äº†
      while (x != start[0] || y != start[1]) {
        path.push(map[y * 100 + x]);
        [x, y] = table[y * 100 + x];
        await sleep(1);
        container.children[y * 100 + x].style.backgroundColor = 'fuchsia';
      }

      return path;
    }

    // æŠŠä¸Šä¸‹å·¦å³æ¨å…¥é˜Ÿåˆ—
    await insert(x - 1, y, [x, y]);
    await insert(x, y - 1, [x, y]);
    await insert(x + 1, y, [x, y]);
    await insert(x, y + 1, [x, y]);

    // æŠŠ 4 ä¸ª æ–œè¾¹æ¨å…¥é˜Ÿåˆ—
    await insert(x - 1, y - 1, [x, y]);
    await insert(x + 1, y - 1, [x, y]);
    await insert(x - 1, y + 1, [x, y]);
    await insert(x + 1, y + 1, [x, y]);
  }

  return null;
}
```

> æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬æŠŠåŸæ¥çš„ `path` å‡½æ•°åæ”¹ä¸ºäº† `findPath`ï¼Œå› ä¸ºåœ¨å¯»æ‰¾è·¯å¾„çš„ `while` å¾ªç¯é‡Œé¢æˆ‘ä»¬ç”¨äº† `path` åšä¸ºè®°å½•è·¯å¾„çš„å˜é‡ã€‚è¿™é‡Œè¿˜éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼Œæˆ‘ä»¬çš„ `find` æŒ‰é’®é‡Œé¢çš„å‡½æ•°è°ƒç”¨ä¹Ÿéœ€è¦ä¸€å¹¶ä¿®æ”¹å“¦ã€‚

```html
<!-- ä¿å­˜åœ°å›¾æ•°æ®åˆ° localStorage -->
<div>
  <button onclick="localStorage['map'] = JSON.stringify(map)">save</button>
  <button onclick="findPath(map, [0,0], [50,50])">find</button>
</div>
```

è¿è¡Œæœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/20200929042259901.png#pic_center)

> [æŸ¥çœ‹æ•ˆæœ](http://tridiamond.tech/frontend-tutorials/exercises/path-finder/4-map-find-path.html) ï½œ [æŸ¥çœ‹ä»£ç ](https://github.com/TriDiamond/frontend-tutorials/blob/master/exercises/path-finder/4-map-find-path.html) ï½œ **å–œæ¬¢çš„åŒå­¦ ğŸŒŸstar ä¸€ä¸‹è°¢è°¢ï¼**

# å¯å‘å¼å¯»è·¯ï¼ˆA\*ï¼‰

åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ•´ä¸ªå¹¿åº¦ä¼˜å…ˆå¯»è·¯çš„ç®—æ³•ã€‚ä½†æ˜¯å¹¿æœå¼å¯»è·¯æ˜¯ä¸æ˜¯æœ€å¥½çš„å¯»è·¯æ–¹æ¡ˆå‘¢ï¼Ÿ`å…¶å®å¹¶ä¸æ˜¯çš„`!

![](https://img-blog.csdnimg.cn/2020092904383578.gif#pic_center)

é€šè¿‡å„ä½æ•°å­¦ç§‘å­¦å®¶çš„åŠªåŠ›ä¸‹ï¼Œä»–ä»¬è¯æ˜äº†ä¸€ä»¶äº‹æƒ…ã€‚æˆ‘ä»¬æ˜¯å¯ä»¥æœ‰ä¸€ç§æ–¹æ³•èƒ½å¤ŸåŠ é€Ÿå¯»è·¯çš„ï¼Œé€šè¿‡ç”¨è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ä¸€ä¸ªéå¸¸å‚»çš„æ–¹å¼æ¥æŒ¨ä¸ªå»æ‰¾ã€‚

> è¿™ç§å¯»è·¯çš„æ–¹å¼å«åš â€œ`å¯å‘å¼å¯»è·¯`â€

> å¯å‘å¼å¯»è·¯å°±æ˜¯ç”¨ä¸€ä¸ªå‡½æ•°å»åˆ¤æ–­è¿™äº›ç‚¹æ‰©å±•çš„ä¼˜å…ˆçº§ã€‚åªè¦æˆ‘ä»¬åˆ¤æ–­å¥½äº†ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬å°±å¯ä»¥æœ‰ç›®çš„çš„å»éªŒè€…æ ¼å­çš„æ–¹å‘åšä¼˜å…ˆæ‰¾è·¯ã€‚

â€œä½†æ˜¯è¿™ä¸ªæ‰¾åˆ°çš„è·¯å¾„æ˜¯ä¸æ˜¯æœ€ä½³è·¯å¾„å‘€ï¼Ÿè¯´çš„é‚£ä¹ˆç¥å¥‡çš„ã€‚â€œ è¯´å®è¯ï¼Œè¿™ä¸ªæˆ‘ä»¬æ™®é€šäººçš„æ€è·¯å°±æ’ä¸ä¸Šç”¨åœºäº†ã€‚ä½†æ˜¯æ•°å­¦å®¶è¯æ˜äº†ä¸€ä»¶äº‹æƒ…ï¼Œåªè¦æˆ‘ä»¬ä½¿ç”¨å¯å‘å¼å‡½æ•°æ¥ä¼°è®¡å€¼ï¼Œå¹¶ä¸”è¿™äº›å€¼èƒ½å¤Ÿä¸€å®šå°äºå½“å‰ç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„çš„é•¿åº¦ï¼Œè¿™æ ·å°±ä¸€å®šèƒ½æ‰¾åˆ°æœ€ä¼˜è·¯å¾„ã€‚

> è¿™ç§èƒ½æ‰¾åˆ°æœ€ä¼˜è·¯å¾„çš„å¯å‘å¼å¯»è·¯ï¼Œåœ¨è®¡ç®—æœºé‡Œé¢æˆ‘ä»¬å«å®ƒåš â€œ`A*`â€ã€‚è¿™é‡Œé¢çš„ `A` ä»£è¡¨ç€ä¸€ç§ä¸ä¸€å®šèƒ½æ‰¾åˆ°æœ€ä¼˜è·¯å¾„çš„å¯å‘å¼å¯»è·¯ã€‚æ‰€ä»¥ `A*` å°±æ˜¯ A å¯»è·¯çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œæ˜¯ä¸€ç§å¯ä»¥æ‰¾åˆ°æœ€ä½³è·¯å¾„çš„ä¸€ç§ç®—æ³•ã€‚

è¦å®ç°è¿™ä¸ªå¯å‘å¼å¯»è·¯ï¼Œå…¶å®æˆ‘ä»¬æ˜¯ä¸éœ€è¦æ”¹è¿‡å¤šæˆ‘ä»¬ `findPath()`å‡½æ•°é‡Œé¢çš„ä»£ç çš„ã€‚æˆ‘ä»¬è¦æ”¹çš„æ˜¯æˆ‘ä»¬å­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ `queue` é˜Ÿåˆ—ã€‚

æˆ‘ä»¬è¦æŠŠ `queue` çš„å…ˆè¿›å…ˆå‡ºå˜æˆä¸€ä¸ª`ä¼˜å…ˆé˜Ÿåˆ— (Prioritized Queue)`ã€‚

æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ª `Sorted` ç±»ï¼Œè¿™ä¸ªç±»æœ‰å‡ ä¸ªå·¥ä½œï¼š

1. è¿™ä¸ªç±»å¯ä»¥å­˜å‚¨æˆ‘ä»¬ä¹‹å‰ `queue` é˜Ÿåˆ—é‡Œé¢çš„æ•°æ®
2. å¯ä»¥æ”¯æŒä¼ å…¥æ’åºå‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯å’Œæˆ‘ä»¬ `array sort` å‡½æ•°ä¸€æ ·çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ’åºè§„åˆ™å‡½æ•°ï¼Œä¹Ÿå« `compare` å‡½æ•°ï¼‰
3. åœ¨æˆ‘ä»¬é€šè¿‡è¿™ä¸ªç±»è·å–å€¼çš„æ—¶å€™ç»™æˆ‘ä»¬æ•°æ®é‡Œé¢çš„æœ€å°å€¼
4. åœ¨æˆ‘ä»¬æ’å…¥æ•°æ®çš„æ—¶å€™ä¸éœ€è¦æ’åºï¼Œåªæ˜¯å•çº¯çš„ä¿å­˜
5. æ¯æ¬¡å»é™¤æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠè¾“å‡ºçš„æ•°æ®åœ¨ç±»çš„æ•°æ®é‡Œé¢åˆ é™¤æ‰
6. è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸€ç›´åœ¨é‡Œé¢è·å–æ•°æ®ï¼ŒçŸ¥é“æ²¡æœ‰æ•°æ®ä¸ºæ­¢
7. æœ€ååŠ å…¥ä¸€ä¸ªå¯ä»¥è·å–å½“å‰æ•°æ®çš„é•¿åº¦ï¼ˆè¿™ä¸ªåœ¨æˆ‘ä»¬çš„å¯»è·¯ç®—æ³•ä¸­éœ€è¦ç”¨åˆ°ï¼‰

> è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªéå¸¸ â€œåœŸé³–â€ çš„æ•°ç»„æ¥å®ç°è¿™ä¸ª Sorted ç±»ï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºå½“ä¸­ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹å¼å¯ä»¥å®ç°è¿™ä¸€ç§ç±»ã€‚æ¯”å¦‚è¯´ `winner tree`ï¼Œ`å † (heap)`ï¼Œ`æ’åºäºŒå‰æ ‘` ç­‰å¾ˆå¤šçš„ä¸åŒæ€è·¯æ¥å®ç°æœ‰åºçš„æ•°æ®ç»“æ„ã€‚

å¥½åºŸè¯å°‘è¯´ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆå®ç°è¿™ä¸ªæ•°æ®ç»“æ„ï¼š

```javascript
/** æ’åºæ•°æ®ç±» */
class Sorted {
  constructor(data, compare) {
    this.data = data.slice();
    this.compare = compare || ((a, b) => a - b);
  }
  take() {
    // è€ƒè™‘åˆ° null ä¹Ÿæ˜¯å¯ä»¥å‚ä¸æ¯”è¾ƒçš„ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å› null æ˜¯ä¸åˆé€‚çš„
    if (!this.data.length) return;
    // è®°å½•æœ€å°çš„å€¼
    // é»˜è®¤ç¬¬ä¸€ä¸ªä½ç½®ä¸ºæœ€å°å€¼
    let min = this.data[0];
    // è®°å½•æœ€å°å€¼çš„ä½ç½®
    let minIndex = 0;

    // å¼€å§‹æ¯”è¾ƒæ•°ç»„é‡Œé¢çš„æ‰€æœ‰å€¼ï¼Œæ‰¾åˆ°æ›´å°çš„å€¼ï¼Œå°±è®°å½•ä¸º min
    // åŒæ—¶è®°å½•æœ€å°å€¼ï¼Œå’Œæœ€å°å€¼çš„ä½ç½®
    for (let i = 1; i < this.data.length; i++) {
      if (this.compare(this.data[i], min) < 0) {
        min = this.data[i];
        minIndex = i;
      }
    }

    // ç°åœ¨æˆ‘ä»¬è¦æŠŠæœ€å°å€¼æ‹¿å‡ºå»äº†ï¼Œæ‰€ä»¥è¦åœ¨æˆ‘ä»¬å½“å‰çš„æ•°æ®ä¸­ç§»é™¤
    // è¿™é‡Œæˆ‘ä»¬ä¸è€ƒè™‘ä½¿ç”¨ spliceï¼Œå› ä¸º splice ç§»é™¤ä¼šæ¶‰åŠæ•°ç»„å†…çš„å…ƒç´ éƒ½è¦å¾€å‰æŒªåŠ¨
    // è¿™æ · splice å°±ä¼šæœ‰ä¸€ä¸ª O(N) çš„æ—¶é—´å¤æ‚åº¦
    // è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå°æŠ€å·§ï¼ŒæŠŠæ•°ç»„é‡Œé¢æœ€åä¸€ä½çš„å€¼æŒªåŠ¨åˆ°å½“å‰å‘ç°æœ€å°å€¼çš„ä½ç½®
    // æœ€åä½¿ç”¨ pop æŠŠæœ€åä¸€ä½æ•°æ®ç§»é™¤
    this.data[minIndex] = this.data[this.data.length - 1];
    this.data.pop();
    // æœ€åæŠŠæœ€å°å€¼è¾“å‡º
    return min;
  }
  give(value) {
    this.data.push(value);
  }
  get length() {
    return this.data.length;
  }
}
```

æœ‰äº†è¿™ä¸ª `Sorted` çš„æ•°æ®ç»“æ„ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ¥è§£å†³æˆ‘ä»¬çš„å¯»è·¯é—®é¢˜ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æœ€ä½³çš„è·¯å¾„äº†ã€‚

åŠ å…¥è¿™ä¸ªæœ€ä½³è·¯å¾„çš„é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦æ”¹åˆ°ä¸€ä¸‹å‡ ä¸ªç‚¹ï¼š

1. é¦–å…ˆæ”¹å†™æˆ‘ä»¬çš„å­˜å‚¨æ•°æ®çš„ `queue`ï¼Œä½¿ç”¨æˆ‘ä»¬ `Sorted` çš„æ’åºæ•°æ®ç»“æ„
2. ç¼–å†™ä¸€ä¸ª `distance()` å‡½æ•°æ¥è¿ç®—ä»»ä½•ä¸€ä¸ªæ ¼å­ä¸ç»ˆç‚¹æ ¼å­çš„ç›´çº¿è·ç¦»
3. æŠŠæ‰€æœ‰å…¥é˜Ÿåˆ—å’Œå‡ºé˜Ÿåˆ—çš„è°ƒç”¨æ”¹ä¸ºä½¿ç”¨ `Sorted` ç±»é‡Œé¢çš„ `take` å–å€¼ å’Œ `give` æ’å…¥å€¼å‡½æ•°
4. å…¶ä»–åœ°æ–¹åŸºæœ¬å°±æ²¡æœ‰ä»€ä¹ˆæ”¹å˜äº†

æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç æ˜¯æ€ä¹ˆå®ç°çš„ï¼š

```javascript
// ä¸Šä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œå°±å¿½ç•¥äº†...
// åªè¦åœ¨ä¸Šéƒ¨åˆ†çš„ä»£ç åé¢æ”¹é€ è¿™éƒ¨åˆ†å³å¯

/**
 * å¯»è·¯æ–¹æ³• (å¼‚æ­¥)
 * @param {Array} map åœ°å›¾æ•°æ®
 * @param {Array} start èµ·ç‚¹ ä¾‹å¦‚ï¼š[0, 0]
 * @param {Array} end ç»ˆç‚¹ ä¾‹å¦‚ï¼š[50, 50]
 * @return Boolean
 */
async function findPath(map, start, end) {
  // åˆ›å»ºä¸€ä¸ªè®°å½•è¡¨æ ¼
  let table = Object.create(map);
  let queue = new Sorted([start], (a, b) => distance(a) - distance(b));

  async function insert(x, y, pre) {
    // åˆ°è¾¾åº•ç›˜è¾¹ç¼˜ï¼Œç›´æ¥åœæ­¢
    if (x < 0 || x >= 100 || y < 0 || y >= 100) return;
    // é‡åˆ°åœ°å›¾çš„å¢™ï¼Œä¹Ÿåœæ­¢
    if (table[y * 100 + x]) return;
    // åŠ å…¥ 30 æ¯«ç§’çš„åœé¡¿ï¼Œè®©æˆ‘ä»¬å¯ä»¥çœ‹åˆ° UI ä¸Šé¢çš„å˜åŒ–
    await sleep(1);
    // ç»™æœç´¢åˆ°çš„è·¯å¾„çš„æ ¼å­åŠ ä¸ŠèƒŒæ™¯é¢œè‰²
    container.children[y * 100 + x].style.backgroundColor = 'DARKSLATEBLUE';
    // æ ‡è®°èµ°è¿‡çš„æ ¼å­çš„å€¼ï¼Œæ ‡è®°ä¸ºä¸Šä¸€ä¸ªæ ¼å­çš„ xï¼Œy ä½ç½®
    table[y * 100 + x] = pre;
    // æŠŠå¯èµ°çš„è·¯æ¨å…¥é˜Ÿåˆ—
    queue.give([x, y]);
  }

  /**
   * è·å–æ ¼ä¸æ ¼ä¹‹å‰çš„è·ç¦»
   * @param {Array} point å½“å‰æ ¼å­çš„åæ ‡ï¼š[x,y]
   */
  function distance(point) {
    // ä½¿ç”¨ä¸‰è§’å½¢ x^2 + y^2 = z^2 çš„æ–¹å¼æ¥è®¡ç®—è·ç¦»
    return (point[0] - end[0]) ** 2 + (point[1] - end[1]) ** 2;
  }

  // å¾ªç¯æ ¼å­ 4 è¾¹çš„æ ¼å­
  while (queue.length) {
    let [x, y] = queue.take();
    // console.log(x, y);

    // é‡åˆ°äº†ç»ˆç‚¹ä½ç½®å°±å¯ä»¥è¿”å›äº†
    if (x === end[0] && y === end[1]) {
      let path = [];

      // å¾€å›èµ°ï¼Œç›´åˆ°èµ°åˆ°èµ·ç‚¹
      // è¿™æ ·å°±èƒ½ç”»å‡ºæœ€ä½³è·¯å¾„äº†
      while (x != start[0] || y != start[1]) {
        path.push(map[y * 100 + x]);
        [x, y] = table[y * 100 + x];
        container.children[y * 100 + x].style.backgroundColor = 'fuchsia';
      }

      return path;
    }

    // æŠŠä¸Šä¸‹å·¦å³æ¨å…¥é˜Ÿåˆ—
    await insert(x - 1, y, [x, y]);
    await insert(x, y - 1, [x, y]);
    await insert(x + 1, y, [x, y]);
    await insert(x, y + 1, [x, y]);

    // æŠŠ 4 ä¸ª æ–œè¾¹æ¨å…¥é˜Ÿåˆ—
    await insert(x - 1, y - 1, [x, y]);
    await insert(x + 1, y - 1, [x, y]);
    await insert(x - 1, y + 1, [x, y]);
    await insert(x + 1, y + 1, [x, y]);
  }

  return null;
}
```

è¿™ä¸ªæœ€ç»ˆçš„è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/20200929052123673.png#pic_center)

> [æŸ¥çœ‹æ•ˆæœ](http://tridiamond.tech/frontend-tutorials/exercises/path-finder/6-map-best-path.html) ï½œ [æŸ¥çœ‹ä»£ç ](https://github.com/TriDiamond/frontend-tutorials/blob/master/exercises/path-finder/6-map-best-path.html) ï½œ **å–œæ¬¢çš„åŒå­¦ ğŸŒŸstar ä¸€ä¸‹è°¢è°¢ï¼**
